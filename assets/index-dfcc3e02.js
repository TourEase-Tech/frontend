var M=Object.defineProperty;var _=(t,r,n)=>r in t?M(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n;var f=(t,r,n)=>(_(t,typeof r!="symbol"?r+"":r,n),n);import{q as A,s as D,t as T,u as O,i as E,M as Q,j as e,B as w,T as g,p as k,n as b,r as N,N as L,O as H,L as C,H as W}from"./index-ef4d341e.js";import{l as U}from"./lodash-cbe3bf36.js";import{u as z}from"./useQueryParam-bbcb7396.js";import{H as P,u as F}from"./HeaderTable-430409b0.js";import{S as j}from"./sweetalert2.all-bda1bb26.js";import{S as v}from"./Skeleton-d5f7679c.js";import{A as $}from"./Avatar-a10f41aa.js";const S=()=>{const t=z();return U.omitBy({search:t.fields,sort:t.sort,limit:t.limit||10,page:t.page||1},U.isUndefined)},B={getAllUsers:t=>A.get("v1/users/",{params:t}),unlockOrLockUser:t=>A.patch(`v1/users/lockOrUnlockAccount/${t}`)};class Y{constructor(){f(this,"_query");f(this,"_queryUserConfig");this._queryUserConfig=S(),this._query=D({queryKey:["users",this._queryUserConfig],queryFn:()=>B.getAllUsers(this._queryUserConfig),keepPreviousData:!0,staleTime:3*60*1e3})}fetch(){var r;return(r=this._query.data)==null?void 0:r.data.data.data}getTotal(){var r;return(r=this._query.data)==null?void 0:r.data.total}isLoading(){return this._query.isLoading}}class I{constructor(){f(this,"_queryClient");f(this,"_unlockOrLockUserMutation");f(this,"handle",(r,n,m)=>this._unlockOrLockUserMutation.mutate(r,{onSuccess:()=>{this._queryClient.invalidateQueries({queryKey:["profile"]}),this._queryClient.invalidateQueries({queryKey:["users"]}),n()},onError:i=>{m(i)}}));this._queryClient=T(),this._unlockOrLockUserMutation=O({mutationFn:r=>B.unlockOrLockUser(r)})}}const K=[{id:"1",name:"Author",sort:"email"},{id:"2",name:"Status",sort:""},{id:"3",name:"Phone number",sort:"phonenumber"},{id:"4",name:"Address",sort:"address"}],R=t=>({true:"Active",false:"Lock"})[`${t}`],G=({user:t,handleClose:r})=>{const n=E(),i=Q().state,s=new I,u=x=>{j.fire({title:"You want to lock this account?",text:"You will not be able to undo once confirmed!",icon:"info",showCancelButton:!0,confirmButtonColor:"#26C6DA",cancelButtonColor:"#dc2626",confirmButtonText:"Confirm",cancelButtonText:"Cancel"}).then(h=>{h.isConfirmed&&s.handle(x,()=>{j.fire("Lock success!","Account locked","success"),r(),n({pathname:k.user,search:b(i).toString()})},p=>{j.fire("Lỗi!",p.response.data.message,"error")})})},y=x=>{j.fire({title:"You want to unlock this account?",text:"You will not be able to undo once confirmed!",icon:"info",showCancelButton:!0,confirmButtonColor:"#26C6DA",cancelButtonColor:"#dc2626",confirmButtonText:"Confirm",cancelButtonText:"Cancel"}).then(h=>{h.isConfirmed&&s.handle(x,()=>{j.fire("Unlock success!","Account active","success"),r(),n({pathname:k.user,search:b(i).toString()})},p=>{j.fire("Lỗi!",p.response.data.message,"error")})})};return e.jsx("div",{className:"flex flex-col justify-between gap-6 items-center bg-white p-6 rounded-lg w-[500px]",children:t&&e.jsxs("div",{className:"w-full flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx("h2",{className:"text-[20px] font-semibold",children:"Profile Account"}),e.jsx(w,{classNameButton:"p-2 hover:bg-slate-100 rounded-lg",onClick:r,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex flex-col gap-5 py-5 ",children:[e.jsx(g,{disabled:!0,id:"outlined-disabled",label:"Email",value:t.email}),e.jsx(g,{disabled:!0,id:"outlined-disabled",label:"First Name",value:t.firstname}),e.jsx(g,{disabled:!0,id:"outlined-disabled",label:"Last Name",value:t.lastname}),e.jsx(g,{disabled:!0,id:"outlined-disabled",label:"Phone Number",value:t.phonenumber}),e.jsx(g,{disabled:!0,id:"outlined-disabled",label:"Address",value:t.address}),e.jsx(g,{disabled:!0,id:"outlined-disabled",label:"Role",value:t.role})]}),e.jsx("div",{className:"w-full flex justify-end",children:t.isActived?e.jsx(w,{classNameButton:"p-2 bg-red-500 text-white rounded-lg",onClick:()=>u(t.id),children:"Lock"}):e.jsx(w,{classNameButton:"p-2 bg-green-500 text-white rounded-lg",onClick:()=>y(t.id),children:"Unlock"})})]})})},J=({users:t,onSort:r,isLoading:n})=>{const[m,i]=N.useState(!1),[s,u]=N.useState(null),y=o=>{i(!0),u(o)},x=()=>{i(!1),u("")},h=o=>{let c=0,l;for(l=0;l<o.length;l+=1)c=o.charCodeAt(l)+((c<<5)-c);let a="#";for(l=0;l<3;l+=1){const q=c>>l*8&255;a+=`00${q.toString(16)}`.slice(-2)}return a},p=o=>{const c=o.split(" ").map(l=>l[0]).join("").toUpperCase();return{sx:{bgcolor:h(o)},children:c}};return e.jsxs("div",{children:[e.jsxs("table",{className:"w-full bg-white text-left border-[1px] border-gray-200 p-2",children:[e.jsx(P,{header:K,onSort:r}),e.jsx("tbody",{children:n?Array(10).fill(0).map((o,c)=>e.jsxs("tr",{className:"text-[14px] text-gray-600 border-b-[1px] border-gray-200 cursor-pointer hover:bg-gray-50",children:[e.jsx("th",{className:"px-2 py-4 font-medium w-[40%]",children:e.jsx(v,{variant:"text",sx:{fontSize:"1rem"}})}),e.jsx("th",{className:"px-2 py-4 font-medium w-[20%]",children:e.jsx(v,{variant:"text",sx:{fontSize:"1rem"}})}),e.jsx("th",{className:"px-2 py-4 font-medium w-[20%]",children:e.jsx(v,{variant:"text",sx:{fontSize:"1rem"}})}),e.jsx("th",{className:"px-2 py-4 font-medium w-[20%]",children:e.jsx(v,{variant:"text",sx:{fontSize:"1rem"}})})]},c)):t&&t.map(o=>e.jsxs("tr",{className:"text-[14px] text-gray-600 border-b-[1px] border-gray-200 cursor-pointer hover:bg-gray-50",onClick:()=>y(o),children:[e.jsxs("th",{className:"px-2 py-4 font-medium w-[40%] flex gap-2",children:[e.jsx($,{...p(`${o.firstname}`),className:"z-10"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{children:[o.firstname," ",o.lastname]}),o.email]})]}),e.jsx("th",{className:"px-2 py-4 font-medium w-[20%] text-center",children:e.jsx("span",{className:L("px-3 py-1 rounded-xl",{"bg-red-500":!o.isActived,"bg-green-500":o.isActived}),children:R(o.isActived)})}),e.jsx("th",{className:"px-2 py-4 font-medium w-[20%] text-center",children:o.phonenumber}),e.jsx("th",{className:"px-2 py-4 font-medium w-[20%] text-center truncate",children:o.address})]},o.id))})]}),e.jsx(H,{isOpenModal:m,handleClose:x,children:e.jsx(G,{user:s,handleClose:x})})]})},d=2,V=({queryConfig:t,total:r,pathname:n,className:m,setPage:i})=>{const s=Number(t.page),u=Math.ceil(r/t.limit),y=()=>{let x=!1,h=!1;const p=c=>x?null:(x=!0,e.jsx("span",{className:"mx-1 border-[1px] border-gray-200 rounded flex h-8 w-8 items-center justify-center text-gray-600 shadow-sm",children:"..."},c)),o=c=>h?null:(h=!0,e.jsx("span",{className:"mx-1 border-[1px] border-gray-200 rounded flex h-8 w-8 items-center justify-center text-gray-600 shadow-sm",children:"..."},c));return Array(u).fill(0).map((c,l)=>{const a=l+1;if(s<=d*2+1&&a>s+d&&a<u-d+1)return o(l);if(s>d*2+1&&s<u-d*2){if(a>d&&a<s-d)return p(l);if(a>s+d&&a<u-d+1)return o(l)}else if(s>=u-d*2&&a>d&&a<s-d)return p(l);return i?e.jsx(w,{classNameButton:L("mx-1 flex h-8 w-8 cursor-pointer items-center justify-center text-center text-gray-600 shadow-sm rounded border-[1px]",{"bg-[#26C6DA]/30  border-[#26C6DA]":a===s,"border-x-gray-200":a!==s}),onClick:()=>i(a),children:a},l):e.jsx(C,{to:{pathname:n,search:b({...t,page:a.toString()}).toString()},className:L("mx-1 flex h-8 w-8 cursor-pointer items-center justify-center text-center text-gray-600 shadow-sm rounded border-[1px]",{"bg-[#26C6DA]/30  border-[#26C6DA]":a===s,"border-x-gray-200":a!==s}),children:a},l)})};return e.jsx("div",{className:m,children:e.jsxs("div",{className:"mt-6 flex flex-wrap justify-center",children:[s===1?e.jsx("span",{className:"mx-1 border-[1px] border-gray-200 rounded flex h-8 w-8 cursor-not-allowed items-center justify-center text-gray-600 shadow-sm bg-gray-100",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"h-4 w-4 text-[#26C6DA]",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})})}):i?e.jsx(w,{classNameButton:"mx-1 border-[1px] border-gray-200 rounded flex h-8 w-8 cursor-pointer items-center justify-center text-gray-600 shadow-sm hover:bg-gray-100",onClick:()=>i(s-1),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"h-4 w-4 text-[#26C6DA]",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})})}):e.jsx(C,{to:{pathname:n,search:b({...t,page:(s-1).toString()}).toString()},className:"mx-1 border-[1px] border-gray-200 rounded flex h-8 w-8 cursor-pointer items-center justify-center text-gray-600 shadow-sm hover:bg-gray-100",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"h-4 w-4 text-[#26C6DA]",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})})}),y(),s===u?e.jsx("span",{className:"mx-1 border-[1px] border-gray-200 rounded flex h-8 w-8 cursor-not-allowed items-center justify-center  text-gray-600 shadow-sm bg-gray-100",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"h-4 w-4 text-[#26C6DA]",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})})}):i?e.jsx(w,{classNameButton:"mx-1 border-[1px] border-gray-200 rounded flex h-8 w-8 cursor-pointer items-center justify-center text-gray-600 shadow-sm hover:bg-gray-100",onClick:()=>i(s+1),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"h-4 w-4 text-[#26C6DA]",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})})}):e.jsx(C,{to:{pathname:n,search:b({...t,page:(s+1).toString()}).toString()},className:"mx-1 border-[1px] border-gray-200 rounded flex h-8 w-8 cursor-pointer items-center justify-center  text-gray-600 shadow-sm",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"h-4 w-4 text-[#26C6DA]",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})})})]})})},X=()=>{const t=S(),r=F({queryConfig:t,pathname:k.user}),n=new Y,m=n.fetch(),i=n.getTotal();return e.jsxs(N.Fragment,{children:[e.jsxs(W,{children:[e.jsx("title",{children:"Users"}),e.jsx("meta",{name:"description",content:"This is user management page of the project"})]}),e.jsx(J,{users:m,onSort:r.handleSort,isLoading:n.isLoading()}),i&&e.jsx(V,{className:"flex justify-end",queryConfig:t,total:n.getTotal(),pathname:k.user})]})},le=X;export{le as default};
