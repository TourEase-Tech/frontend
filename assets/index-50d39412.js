import{j as e,x as E,i as B,r as m,k as _,H as I,B as O,P as q,L as M,p as l,n as p,o as Q}from"./index-e884cf42.js";import{u as R}from"./useQueryTourConfig-85369db5.js";import{H as G,u as W}from"./HeaderTable-7aafac3d.js";import{t as P}from"./tour.services-380586fc.js";import{u as J,G as K,I as U,F as X,P as Y}from"./useQuerySearchTourConfig-9d54ab95.js";import"./lodash-8a59e353.js";import{S as u}from"./Skeleton-f3a4ade7.js";import{F as Z}from"./filter_tour.rules-a78ca2a3.js";import"./useQueryParam-268f35b5.js";const D=[{id:"1",name:"Name",sort:"name"},{id:"2",name:"Location",sort:"departureLocation"},{id:"3",name:"Destination",sort:"destination"},{id:"4",name:"Departure Day",sort:"phonenumber"},{id:"5",name:"Price",sort:"price"}],ee=({tours:a,onEditTour:n,isLoading:i,onSort:f})=>e.jsx("div",{children:e.jsxs("table",{className:"w-full bg-white text-left border-[1px] border-gray-200 p-2",children:[e.jsx(G,{header:D,onSort:f}),e.jsx("tbody",{children:i?Array(10).fill(0).map((s,g)=>e.jsxs("tr",{className:"text-[14px] text-gray-600 border-b-[1px] border-gray-200 cursor-pointer hover:bg-gray-50",children:[e.jsx("th",{className:"px-2 py-4 font-medium w-[30%]",children:e.jsx(u,{variant:"text",sx:{fontSize:"1rem"}})}),e.jsxs("th",{className:"px-2 py-4 font-medium w-[17%]",children:[e.jsx(u,{variant:"text",sx:{fontSize:"1rem"}})," "]}),e.jsxs("th",{className:"px-2 py-4 font-medium w-[17%]",children:[e.jsx(u,{variant:"text",sx:{fontSize:"1rem"}})," "]}),e.jsxs("th",{className:"px-2 py-4 font-medium w-[17%]",children:[e.jsx(u,{variant:"text",sx:{fontSize:"1rem"}})," "]}),e.jsxs("th",{className:"px-2 py-4 font-medium w-[17%]",children:[e.jsx(u,{variant:"text",sx:{fontSize:"1rem"}})," "]})]},g)):a&&a.map(s=>e.jsxs("tr",{className:"text-[14px] text-gray-600 border-b-[1px] border-gray-200 cursor-pointer hover:bg-gray-50",onClick:()=>n(s.id),children:[e.jsx("th",{className:"px-2 py-4 font-medium w-[30%] text-center",children:e.jsx("span",{className:"line-clamp-2 ",children:s.name})}),e.jsx("th",{className:"px-2 py-4 font-medium w-[17%] text-center",children:s.departureLocation}),e.jsx("th",{className:"px-2 py-4 font-medium w-[17%] text-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:s.destination})}),e.jsx("th",{className:"px-2 py-4 font-medium w-[17%] text-center",children:E(s.departureDay)}),e.jsxs("th",{className:"px-2 py-4 font-medium w-[17%] text-center truncate",children:[Number(s.price).toLocaleString()," VND"]})]},s.id))})]})}),te=()=>{const a=R(),n=J(),i=B(),f=W({queryConfig:a,pathname:l.tour}),s=new K(a),g=s.fetch(),v=s.getTotal(),[d,c]=m.useState(!1),[F,x]=m.useState(!1),[L,y]=m.useState([]),[C,S]=m.useState(""),[w,N]=m.useState(null),z=r=>{N(r.currentTarget)},j=()=>{N(null)},b=!!w,k=b?"popover":void 0,H=r=>{i({pathname:l.edit_tour,search:p({id:r}).toString()},{state:{...d?n:a,isSearching:d}})},o=_({resolver:Q(Z)}),V=async r=>{try{const t=await P.getToursBySearch(r);t.data.data?(x(!1),c(!0),y(t.data.data),S(t.data.total)):(c(!0),x(!0))}catch(t){console.error("Error fetching tours:",t)}},T=r=>{const t={};if(r.destination&&(t.destination=r.destination),r.departureLocation&&(t.departureLocation=r.departureLocation),r.period&&(t.period=r.period),r.maxPrice&&(t.maxPrice=r.maxPrice),r.minPrice&&(t.minPrice=r.minPrice),t.limit=n.limit,t.page=n.page,Object.keys(t).length>0){V(t),c(!0),j();const h=p({...a,...t,page:"1"}).toString();i(`${l.tour}?${h}`)}else{c(!1);const h=p({...a,page:"1"});i(`${l.tour}?${h}`)}},$=()=>{o.resetField("destination"),o.resetField("departureLocation"),o.resetField("period"),o.resetField("maxPrice"),o.resetField("minPrice"),j(),c(!1),x(!1),i(l.tour)},A=async r=>{try{if(d){const t=await P.getToursBySearch({...n,page:r.toString()});t.data.data?(x(!1),c(!0),y(t.data.data),S(t.data.total)):(c(!0),x(!0));const h=p({...n,page:r.toString()}).toString();i(`${l.tour}?${h}`)}else{const t=p({...a,page:r.toString()}).toString();i(`${l.tour}?${t}`)}}catch(t){console.error("Error fetching tours:",t)}};return e.jsxs(m.Fragment,{children:[e.jsxs(I,{children:[e.jsx("title",{children:"Tours"}),e.jsx("meta",{name:"description",content:"This is tours management page of the project"})]}),e.jsxs("div",{className:"flex flex-col justify-center ",children:[e.jsxs("div",{className:"flex w-full justify-between items-center pt-[16px] pb-[40px] font-normal relative ",children:[e.jsx("form",{onSubmit:o.handleSubmit(T),children:e.jsx(U,{classNameInput:"bg-white border-[1px] rounded-md md:h-[44px] md:w-[500px] max-md:h-[30px] max-md:w-[250px] outline-none pl-8 pr-2 shadow-[0_3px_10px_rgb(0,0,0,0.2)] font-normal text-gray-600 placeholder:font-normal placeholder:text-[14px] max-md:placeholder:text-[12px]",name:"destination",placeholder:"Search",register:o.register})}),e.jsxs("div",{className:"w-full flex justify-end mx-auto gap-4 ",children:[e.jsxs(O,{onClick:z,classNameButton:"flex items-center gap-1 text-[14px] font-semibold text-white bg-[#26C6DA] px-4 py-2 max-md:px-3 rounded-lg cursor-pointer",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"lg:w-6 lg:h-6 md:w-5 md:h-5 max-md:w-4 max-md:h-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 01-.659 1.591l-5.432 5.432a2.25 2.25 0 00-.659 1.591v2.927a2.25 2.25 0 01-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 00-.659-1.591L3.659 7.409A2.25 2.25 0 013 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0112 3z"})}),e.jsx("span",{className:"max-md:text-[12px]",children:"Filter"})]}),e.jsx(q,{id:k,open:b,anchorEl:w,onClose:j,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},anchorReference:"anchorEl",children:e.jsx("form",{onSubmit:o.handleSubmit(T),children:e.jsx(X,{control:o.control,onResetForm:$})})}),e.jsx(M,{to:l.create_tour,state:a,className:"flex  items-end justify-end text-[14px] font-semibold text-white bg-[#26C6DA] px-4 py-2 rounded-lg ",children:"Create Tour"})]})]}),F?e.jsx("div",{className:"flex w-full items-center justify-center min-h-[500px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex rounded-full bg-[#c6f8ff] p-4 overflow-hidden",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",id:"calendar",className:"w-16 h-16",children:e.jsx("path",{d:"M53 5h-8v4H19V5h-8v4H0v50h64V9H53V5zm-6 2h4v6h-4V7zM13 7h4v6h-4V7zM2 57V19h60v38H2zm60-46v6H2v-6h9v4h8v-4h26v4h8v-4h9z"})})}),e.jsx("h1",{className:"mt-5 lg:text-[40px] md:text-[20px] max-md:text-[14px] font-bold text-slate-800",children:"No tours found"})]})}):e.jsx(ee,{tours:d?L:g,onEditTour:H,onSort:f.handleSort,isLoading:s.isLoading()}),v&&e.jsx(Y,{className:"flex justify-end",queryConfig:d?n:a,total:d?C:v,handlePageChange:A})]})]})},me=te;export{me as default};
